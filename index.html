
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>作业作答</title>
<link rel="stylesheet" type="text/css" href="/mooc2/css/pop.css"/>
<link rel="stylesheet" type="text/css" href="/mooc2/css/common.css" />
<link rel="stylesheet" type="text/css" href="/mooc2/css/marking_icon.css" />
<link rel="stylesheet" type="text/css" href="/mooc2/css/icomoon.css" />
<link rel="stylesheet" type="text/css" href="/mooc2/css/viewStudent.css?v=2022-0310-1100" />
<link rel="stylesheet" type="text/css" href="/mooc2/css/oralTest.css?v=2022-0726-1100" />
<link rel="stylesheet" type="text/css" href="/mooc2/css/newBuilt.css?v=2020-0827-0900" />
<link href="/mooc2/css/font.css?v=2022-0902-1500" rel="stylesheet" type="text/css" /><script type="text/javascript" src="/js/common/jquery.min.js"></script>
<script type="text/javascript" src="/js/common/jquery-migrate.min.js"></script><script type="text/javascript" src="/js/jquery.nicescroll.min.js"></script>
<script type="text/javascript" src="/mooc2/js/dowork-select.js"></script>
<script type="text/javascript" src="/js/phone/textareaHeightAuto.js"></script>
<script type="text/javascript" src="/mooc2/js/common.js"></script>
<script type="text/javascript" src="/mooc2/js/pop.js"></script>
<script type="text/javascript" src="/mooc2/js/poplayout.js?v=2022-0218-1500"></script>
<script type="text/javascript" src="/mooc2/js/viewStudent.js?v=2020-0821-1100"></script>
<script type="text/javascript" src="/mooc2/js/oraltest.js?v=2022-0906-1100"></script>

<script src="/space/work/js/attach-mark.js?v=2022-0802-1500"></script><script src="/space/work/js/preview-attach.js?v=2022-0921-1530"></script><link href="/css/work/viewer.min.css?v=2021-0830-1700" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/js/jquery.md5.js"></script>
<script type="text/javascript" src="/space/work/js/viewer-jquery.min.js?v=2021-0706-1800"></script>
<script type="text/javascript">
try{
	$(function(){
		var imgList = $(".TiMu").find("div img:not(.workAttach img, .attach img, .attachNew img, .stuAnswerArea img, .popClose img, .ans-formula-moudle, .no_view)");
		for (var i = 0, len = imgList.size(); i < len; i++) {
			 var src = imgList.eq(i).attr("src");
			 if(src){
    			var index = src.indexOf("375_1024");
    			if (index != -1) {
    				src = src.replace("375_1024", "origin");
    			}
                 var index2 = src.indexOf("750_1024");
                 if (index2 != -1) {
                     src = src.replace("750_1024", "origin");
                 }
    			imgList.eq(i).attr("data-original", src);
		   }
		}
        $(".TiMu").find("div img:not(.workAttach img, .attach img, .attachNew img, .stuAnswerArea img, .popClose img, .no_view)").viewer({
			url : 'data-original',
		});
	})
  }catch(error){}
</script><script>
function editorPaste(o, html) {
	html.html = "";
	$.toast({
		type : 'notice',
		content : "只能录入不能粘贴！"
	});
	return false;
}
window["uid"] = '82458881';
window["currentTime"] = '1665821803398';
window["uploadEnc"] = 'c9c150052f4854a99af5fda0f616c1e1';
</script>
</head>
<style>
.questionLi img{max-width:100%;}
.dtk .answerBg{display:inline-block;}
.dtk .answerBg:hover{background:none}
.borblue{border:1px solid #3A8BFF !important;}
.borred{border:1px solid #F33F34 !important;}
</style>
<body>
<div class="subNav">
	<div class="sub-button fr">
				<a href="javascript:;" onclick="saveWork();" class="fl">保存</a>
											<a href="javascript:;" onclick="submitValidate();" class="completeBtn fl">提交</a>
						</div>作业</div>
<div class="het40"></div>

<script type="text/javascript" charset="utf-8" src="/js/ServerHost.js?v=2020-1225-1627"></script>
<script type="text/javascript" charset="utf-8" src="/mooc2/js/editor/ueditor.config.js?v=2022-0802-1450"></script>
<script type="text/javascript" charset="utf-8" src="/mooc2/js/editor/ueditor.all.min.js?v=2022-0916-1700"></script>
<script>
    function getcookie(objname){
    	var arrstr = document.cookie.split("; ");
    	for(var i = 0;i < arrstr.length;i ++){
    		var temp = arrstr[i].split("=");
    		if(temp[0] == objname){ 
    			return unescape(temp[1]);
    		}
    	}
    }
	window["uid"] = '82458881';
	window["currentTime"] = '1665821803398';
	window["uploadEnc"] = 'c9c150052f4854a99af5fda0f616c1e1';
	window.UEDITOR_CONFIG.forbidDownload = '';
	window.UEDITOR_CONFIG.scaleEnabled = true;
	window.UEDITOR_CONFIG.imageUrl = ServerHost.uploadDomain + "/ueditorupload/upload";
	window.UEDITOR_CONFIG.fileUrl = ServerHost.uploadDomain + "/ueditorupload/attachment";
	window.UEDITOR_CONFIG.lang = 'zh-cn';
	window.fycourseDomain = "mobile3.chaoxing.com";
</script>
<div class="fanyaMarking TiMu" id="fanyaMarking">
	<div class="fanyaMarking_left whiteBg">
		<div class="padBom20 detailsHead">
			<h2 class="mark_title">第八次上机</h2>
			<div class="infoHead">
				<span>题量: 1</span>
				<span>满分: 100.0</span>
				<p>创建者: 漆隆平</p>
				<p>作答时间:<em>10-15 13:55</em>至<em>10-19 18:23</em></p>
							</div>
		</div>

		
				
							<div class="mark_table padTop20">
						<form action="/work/addStudentWorkNewWeb?_classId=61126055&courseid=227595963&token=3acccff79ef3c42e50958f61e15e244c&totalQuestionNum=2d5974984018f63717f37e62700cb7d7" method="post" id="submitForm" name="submitForm" onkeydown="if(event.keyCode==13){return false;}">
			<input type="hidden" id="workObj" value="false" />
			<input type="hidden" id="courseId" name="courseId" value="227595963" />
			<input type="hidden" id="classId" name="classId" value="61126055" />
			<input type="hidden" id="knowledgeId" name="knowledgeid" value="0" />
			<input type="hidden" id="cpi" name="cpi" value="130357341"/>
			<input type="hidden" id="workId" name="workRelationId" value="23104224" />
			<input type="hidden" id="answerId" name="workAnswerId" value="51532711"/>
			<input type="hidden" id="jobid" name="jobid" value=""/>
			<input type="hidden" id="standardEnc" name="standardEnc" value="a52bf24c9d9473c6b8c3b5dd23972e56"/>
			<input type="hidden" id="enc_work" name="enc_work" value="3acccff79ef3c42e50958f61e15e244c"/>
			<input type="hidden" id="totalQuestionNum" name="totalQuestionNum" value="2d5974984018f63717f37e62700cb7d7" />
			<input type="hidden" id="pyFlag" name="pyFlag" value="" />
			<input type="hidden" id="questionIds" name="answerwqbid" value="" />
			<input type="hidden" id="mooc2" name="mooc2" value="1" />
			<input type="hidden" id="uploadTimeStamp" value="1665821803398" />
			<input type="hidden" id="uploadEnc" value="c9c150052f4854a99af5fda0f616c1e1" />
			<input type="hidden" id="uploadtype" value="work" />
			<input type="hidden" id="creatorId" value="130357341" />
			<input type="hidden" id="matchEnc" value="d899fb779448af0d13e3de2048e47061" />
			
								
																				<div class="whiteDiv">
                                    <h2 class="type_tit" >一. 简答题（共1题，100分）</h2>
                																													<div class="padBom50 questionLi" typeName="简答题" id="question402257317" data="402257317">
							<h3 class="mark_name colorDeep fontLabel">1. <span class="colorShallow">(简答题, 100分)</span> <p>1、请在自己的GitHub账号下创建名为 "username.github.io" 的存储库，此处的 username 请用自己的账号代替；</p>
<p>2、然后在这个库的根目录下创建名为 index.html 的文件和另外3个HTML文件，此3个文件需要与index.html文件通过链接关联起来，这就是大家个人网站的初始版本；</p>
<p>3、或者在创建以上仓库后，在git hub网上搜索 personal website，然后根据开源协议，找到自己喜欢的一个个人网站模板，然后把它的代码放到自己刚创建的这个存储库里，再进行修改和提交。</p>
<p><br></p>
<p>4、第2步和第3步只需要进行其中一步，最后请把这个新创建的仓库名称贴到答案里，譬如我的是: seanlaux.github.io，这个实际上就是大家个人网站的网址，大家把这个网址输入到浏览器的地址栏后就可以看到自己的个人网站了。</p></h3>
							<input type="hidden" id="answertype402257317" name="answertype402257317" value="4" />
															
																								
																								
								<div class="stem_answer">
									<div class="eidtDiv">
										<textarea id="answer402257317" name="answer402257317"></textarea>
										<script>
											var wordNum = "";
											if (wordNum == "") {
												wordNum = 0;
											}
											var wordMinNum = "";
											if (wordMinNum == "") {
												wordMinNum = 0;
											}
											var qtype = "4";
											// var wordCount = false;
											// if (qtype == 4) {
											// 	wordCount = true;
											// }
											window.UEDITOR_CONFIG.initialFrameHeight = 150;
											var wordCount = true;
											if (parseInt(wordNum) == 0 && parseInt(wordMinNum) == 0) {
												wordCount = false;
											}
											window.UEDITOR_CONFIG.wordCount = wordCount;
											window.UEDITOR_CONFIG.wordCountTimer = false;
											// window.UEDITOR_CONFIG.maximumWords = wordNum;
											// window.UEDITOR_CONFIG.minimumWords = wordMinNum;
											var editor1 = UE.getEditor("answer402257317");
											editor1.options.maximumWords = wordNum;
											editor1.options.minimumWords = wordMinNum;
											editor1.addListener('blur',function(){
												var count = UE.getEditor("answer402257317").pureWordCount();
												var max = parseInt(UE.getEditor("answer402257317").options.maximumWords);
												var min = parseInt(UE.getEditor("answer402257317").options.minimumWords);
												if (count == 0) {
													$("#answer402257317").parent().find(".edui-editor.edui-default").removeClass("borblue");
													$("#answer402257317").parent().find(".edui-editor.edui-default").removeClass("borred");
												}else if ((max > 0 && count > max) || (min > 0 && min > count)) {
													$("#answer402257317").parent().find(".edui-editor.edui-default").removeClass("borblue");
													$("#answer402257317").parent().find(".edui-editor.edui-default").addClass("borred");
													return;
												} else {
													$("#answer402257317").parent().find(".edui-editor.edui-default").removeClass("borblue");
													$("#answer402257317").parent().find(".edui-editor.edui-default").removeClass("borred");
												}
											});
											editor1.addListener('focus',function(){
												$("#answer402257317").parent().find(".edui-editor.edui-default").addClass("borblue")
												$("#answer402257317").parent().find(".edui-editor.edui-default").removeClass("borred")
											});
											var allowPaste = "0";
											if (parseInt(allowPaste) == 1) {
												editor1.addListener('beforepaste', editorPaste); 
											}
											editor1.addListener('contentChange', function() {
					                            loadEditorAnswerd(402257317, 4);
					                        });
											window.UEDITOR_CONFIG.wordCount = false;
										</script>
									</div>		
								</div>
								
																
																
														
						</div>
															</div>
										</form>
			</div>
			</div>
	
		<div class="fanyaMarking_right" id="rightHeight">
		<div class="topicNumber" id="topicNumberScroll">
			                                    
                                                
						
																				
                        <div class="topicNumber_checkbox colorDeep fs14"><span class="numRight fr"></span>一. 简答题（100分）</div>
                        <ul class="topicNumber_list clearfix">
                                                            <li id="answerSheet402257317" data="402257317" >1</li>
                                                    </ul>
                    									</div>
	</div>
	</div>
<link rel="stylesheet" type="text/css" href="/mooc2/css/prompt.css"/>
<style>
	.mask-no-bg{background:none!important;}
	.mask-no-bg .popDiv{box-shadow: 0px 4px 36px rgba(0, 0, 0, 0.08);}
</style>
<div class="maskDiv" style="display:none;" id="workpop">
	<div class="popDiv wid440 Marking">
		<div class="popHead">
			<a href="javascript:;" class="popClose fr" onclick="$('#workpop').hide();$('.popSetupShowHide').fullFadeOut();"><img src="/images/popClose.png" /></a>
			<p class="fl fs18 colorDeep">提示</p>
		</div>
		<div class="het62"></div>
		<p class="popWord fs16 colorIn" id="popcontent"></p>

		<div class="popBottom">
			<a href="javascript:;" id="popok" class="jb_btn jb_btn_92 fr fs14"></a>
			<a href="javascript:;" id="popno" class="btnBlue btn_92_cancel fr fs14"></a>
		</div>
		<div class="het72"></div>
	</div>
</div>

<div class="mask-no-bg" style="display:none;" id="worktoast">
	<div class="popDiv wid440 Marking" style="top: 30%;">
		<div class="popHead">
			<a href="javascript:;" class="popClose fr" onclick="$('#worktoast').hide();$('.popSetupShowHide').fullFadeOut();"><img src="/images/popClose.png" /></a>
			<p class="fl fs18 colorDeep">提示</p>
		</div>
		<div class="het62"></div>
		<p class="popWord fs16 colorIn" id="toastcontent"></p>

		<div class="popBottom">
			<a href="javascript:;" id="toastok" class="jb_btn jb_btn_92 fr fs14"></a>
			<a href="javascript:;" id="toastno" class="btnBlue btn_92_cancel fr fs14"></a>
		</div>
		<div class="het72"></div>
	</div>
</div>

<script>

function workPop(content, okTent, cancelTent, okcallback, cancelCallback) {
	var ta = $("#workpop");

	$(".popSetupShowHide").fullFadeIn();
	ta.show();
	
	$("#popcontent").html(content);

	var ok = $("#popok");
	ok.html(okTent);
	ok.unbind();
	ok.on("click", function() {
		okcallback && okcallback(ta);
		ta.hide();
		$(".popSetupShowHide").fullFadeOut();
	});

	var cancel = $("#popno");
	cancel.html(cancelTent);
	cancel.unbind();
	cancel.on("click", function() {
		cancelCallback && cancelCallback(ta);
		ta.hide();
		$(".popSetupShowHide").fullFadeOut();
	});
}

function workToast(content, okTent, cancelTent, okcallback, cancelCallback) {
	var ta = $("#worktoast");

	$(".popSetupShowHide").fullFadeIn();
	ta.show();

	$("#toastcontent").html(content);

	var ok = $("#toastok");
	ok.html(okTent);
	ok.unbind();
	ok.on("click", function() {
		okcallback && okcallback(ta);
		ta.hide();
		$(".popSetupShowHide").fullFadeOut();
	});

	var cancel = $("#toastno");
	cancel.html(cancelTent);
	cancel.unbind();
	cancel.on("click", function() {
		cancelCallback && cancelCallback(ta);
		ta.hide();
		$(".popSetupShowHide").fullFadeOut();
	});
}

</script><script>
var courseId = $("#courseId").val();
var classId = $("#classId").val();
var cpi = $("#cpi").val();

function addChoice(obj) {
	var qid = $(obj).attr("qid");
	var qt = $(obj).attr("qtype");

	if ($(obj).find(".num_option").hasClass("check_answer")) {
		$(obj).find(".num_option").removeClass("check_answer");
	} else {
		$(".choice" + qid).removeClass("check_answer");
		$(obj).find(".num_option").addClass("check_answer");
	}

	var choiceContent = "";
	$(".choice" + qid).each(function(index, ele) {
		if ($(this).hasClass("check_answer")) {
			choiceContent = choiceContent + $(this).attr("data");
		}
	});
	$("#answer" + qid).val(choiceContent);
	
	if (qt == 14) {
		var questionId = $(obj).attr("questionId");
		setClozeTextAnswer(questionId);
	} else if (qt == 15 || qt == 19) {
		var questionId = $(obj).attr("questionId");
		loadEditorAnswerd(questionId, qt);
	} else {
		loadAnswerSheet(qid, choiceContent);
	}
}

function addMultipleChoice(obj) {
	var qid = $(obj).attr("qid");
	var qt = $(obj).attr("qtype");
	if(qt == 21 &&  !checkEvaluationQuesNum(obj)){
	  return;
	}
	if ($(obj).find(".num_option_dx").hasClass("check_answer_dx")) {
		$(obj).find(".num_option_dx").removeClass("check_answer_dx");
	} else {
		$(obj).find(".num_option_dx").addClass("check_answer_dx");
	}

	var choiceContent = "";
	$(".choice" + qid).each(function(index, ele) {
		if ($(this).hasClass("check_answer_dx")) {
			choiceContent = choiceContent + $(this).attr("data");
		}
	});
	$("#answer" + qid).val(choiceContent);
	
	if (qt == 15 || qt == 19) {
		var questionId = $(obj).attr("questionId");
		loadEditorAnswerd(questionId, qt);
	} else {
		loadAnswerSheet(qid, choiceContent);
	}
}

function loadAnswerSheet(questionId, content) {
	if($("#answerSheet" + questionId).hasClass("active") && content.length == 0) {
		$("#answerSheet" + questionId).removeClass("active");
	} else if(content.length > 0) {
		$("#answerSheet" + questionId).addClass("active");
	}
}

$(function() {
	$("textarea").autoHeight({
		len : 53
	});

	$(document).ready(function() {
		$(".optionsCon").niceScroll({
			cursorborder : "",
			cursorwidth : "8px",
			cursorcolor : "#E6ECF5",
			boxzoom : false
		});
	});
});


function setConnLineAnswer(qid) {
	var answerArr = [];
	$(".connlineSelect" + qid).each(function() {
		var name = $(this).attr("data");
		var content = $(this).attr("value");
		var obj = {};
		obj.name = name;
		obj.content = content;
		answerArr.push(obj);
	});
	var answer = JSON.stringify(answerArr);
	$("#answer" + qid).val(answer);
	
	loadEditorAnswerd(qid, 11);
}

function setSortAnswer(qid) {
	var answer = "";
	$(".sortSelect" + qid).each(function() {
		var content = $(this).attr("value");
		answer = answer + content;
	});
	$("#answer" + qid).val(answer);
	
	loadEditorAnswerd(qid, 13);
}

function setProceduralAnswer() {
	$(".proceduralQue").each(function() {
		var answer = [];
		var qid = $(this).attr("data");
		var language = $("#languageSelect" + qid).val();
		var editor = UE.getEditor("textarea" + qid);
		var richcode = editor.getContent();
		var code = editor.getPlainTxt();
		code = UE.utils.html(code);
		var item = {};
		item.language = parseInt(language);
		item.answer = richcode;
		item.answerTxt = code;
		answer[0] = item;
		var answerStr = JSON.stringify(answer);
		$("#answer" + qid).val(answerStr);
	});
}


function setAllClozeAnswer() {
	$(".clozeTextQues").each(function() {
		var qid = $(this).attr("data");
		var answerObj = {};
		$(".clozeTextItem" + qid).each(function() {
			var itemId = $(this).attr("data");
			var content = $("#answer" + qid + itemId).val();
			var info = {};
			info.answer = content;
			answerObj[itemId] = info;
		});
		var answer = [];
		answer.push(answerObj);
		var answerStr = JSON.stringify(answer);
		$("#answer" + qid).val(answerStr);
	});
}

function setClozeTextAnswer(qid) {
	var answerObj = {};
	$(".clozeTextItem" + qid).each(function() {
		var itemId = $(this).attr("data");
		var content = $("#answer" + qid + itemId).val();
		var info = {};
		info.answer = content;
		answerObj[itemId] = info;
	});
	var answer = [];
	answer.push(answerObj);
	var answerStr = JSON.stringify(answer);
	$("#answer" + qid).val(answerStr);
	
	loadEditorAnswerd(qid, 14);
}

function setReadComprehensionAnswer() {
	$(".readComprehensionQues").each(function() {
		var answerObj = {};
		var qid = $(this).attr("data");
		$(".readingItem" + qid).each(function() {
			var qtid = $(this).attr("data");
			var itemId = $(this).attr("itemId");
			var type = $(this).attr("qtype");
			var itemAnswer = "";
			switch (parseInt(type)) {
				case 0 :
				case 1 : {
					itemAnswer = $("#answer" + qtid).val();
					break;
				}
				case 3 : {
					itemAnswer = $("#answer" + qtid).val();
					itemAnswer = itemAnswer ? (itemAnswer == "true" ? true : false) : itemAnswer;
					break;
				}
				case 2 : {
					var answerItem = [];
					var blankNum = $("#blankNum" + qtid).val();
					for (var i = 1; i <= blankNum; i++) {
	                    var answerEditorId = "answerEditor" + qtid + i;
	                    var answerEditorStr = UE.getEditor(answerEditorId).getContent();
	                    var item = {};
						item.content = answerEditorStr;
						item.name = i.toString();
						answerItem.push(item);
					}
					itemAnswer = answerItem;
					break;
				}
				case 4 : {
					var answerEditorId = "answer" + qtid;
					var answerEditorStr = UE.getEditor(answerEditorId).getContent();
					itemAnswer = answerEditorStr;
					break;
				}
				default : {}
			}
			var info = {};
			info.type = parseInt(type);
			info.answer = (itemAnswer != undefined ? itemAnswer : "");
			answerObj[itemId] = info;
		});
		var answer = [];
		answer.push(answerObj);
		var answerStr = JSON.stringify(answer);
		$("#answer" + qid).val(answerStr);
	});
}

function submitValidate(pyFlag) {
	$("#pyFlag").val(pyFlag);
	$.ajax({
		type : "get",
		url : "/work/validate",
		data : {
			courseId : courseId,
			classId : classId,
			cpi : cpi
		},
		success : function(data) {
			if (data.status == 1) {
				$.toast({
					type : 'failure',
					content : "账号发生异常，请重新登录！"
				});
				return;
			}
			if (data.status == 2) {
				// 弹出验证码
				ready2Submit();
			}
			if (data.status == 3) {
				ready2Submit();
			}
		}
	});
}

function ready2Submit() {
	var qids = "402257317,";
	$("#questionIds").val(qids);
	var jiandaId = "402257317";
	var wordNum = "0";
	var blankobj = "1";
	var flagAnswer = true;
	if (parseInt(wordNum) > 0) {
		if (jiandaId != "") {
			var jiandaIdArr = jiandaId.split(",");
			for (var i = 0; i < jiandaIdArr.length; i++) {
				var temp = $("#answer" + jiandaIdArr[i]).val();
				if (undefined == temp) {
					continue;
				}
				if ( (wordNum != "" && removeAllSpace(temp, i).length < parseInt(wordNum)) || (wordNum != "" && removeAllSpace(temp, i) == "")) {
					$.toast({
						type : 'failure',
						content : "您最少输入" + wordNum + "个字！"
					});
					flagAnswer = false;
					break;
				}
			}
		}
	}
	if ( !flagAnswer) {
		return;
	}
	
			setAllClozeAnswer();
	setReadComprehensionAnswer();
	setProceduralAnswer();
	
	var questionIds = qids.split(",");
	var flag = false;
	var tipStr = "";
	for (var i = 0; i < questionIds.length - 1; i++) {
		var id = questionIds[i];
		var type = $("#answertype" + id).val();
        tipStr =  $("#answertype" + id).parents('.questionLi').attr("typeName");

        if (type == "0") {
			var answer = $("#answer" + id).val();
			if ( typeof (answer) == "undefined" || removeAllSpace(answer).length == 0) {
				flag = true;
				break;
			}
		} else if (type == "1" || type == "21") {
			var answer = $("#answer" + id).val();
			if ( typeof (answer) == "undefined" || removeAllSpace(answer).length == 0) {
				flag = true;
				break;
			}
		} else if (type == "11" || type == "20") {
			var answer = $("#answer" + id).val();
			if(answer == "" || answer.length == 0){
			    flag = true;
				break;
			}
			var answerArr = JSON.parse(answer);
			for ( var index in answerArr) {
				var content = answerArr[index].content;
				if (content == "" || content.length == 0) {
					flag = true;
					break;
				}
			}
		} else if (type == "13") {
			var answer = $("#answer" + id).val();
			if ( typeof (answer) == "undefined" || removeAllSpace(answer).length == 0) {
				flag = true;
				break;
			}
		} else if (type == "14" || type == "15" || type == "16" || type == "19") {

			var answer = $("#answer" + id).val();
			var answerArr = JSON.parse(answer);
			var answerContent = answerArr[0];
			for ( var key in answerContent) {
				var content = answerContent[key];
				var answerStr = content.answer;
				var innerType = content.type;
				if (innerType && innerType == 2) {
					for ( var index in answerStr) {
						var item = answerStr[index];
						var content = item.content;
						if (content == "" || content.length == 0) {
							flag = true;
							break;
						}
					}
				}
				if (innerType == 3) {
					answerStr = answerStr.toString();
				}
				if (flag || answerStr == "" || answerStr.length == 0) {
					flag = true;
					break;
				}
			}

			if (flag) {
				break;
			}
		} else if (type == "17") {
			try {
				var language = $("#procedural-" + id + " .languageSelect").val();
				if (language == "-1") {
					flag = true;
					break;
				}
				var editor = UE.getEditor("textarea" + id);
				var pureTxt = editor && editor.getContentTxt();
				if (pureTxt.length == 0 || pureTxt == "") {
					flag = true;
					break;
				}
			} catch (exception) {}
		} else if (type == "2" || type == "9" || type == "10") {
			var blankNum = $("input[name=tiankongsize" + id + "]").val();
			var tem = false;
			for (var j = 1; j <= parseInt(blankNum); j++) {
				var answer;
				try {
					var optEditor = UE.getEditor("answerEditor" + id + j);
					if (optEditor != null) {
						answer = optEditor.getContent();
					}
				} catch (exception) {}
				if ( typeof (answer) != "undefined" && removeAllSpace(answer).length != 0) {
					if (parseInt(wordNum) > 0 && removeAllSpace(answer).length < parseInt(wordNum) && blankobj == 0) {
						$.toast({
							type : 'failure',
							content : "您最少输入" + wordNum + "个字！"
						});
						flagAnswer = false;
						break;
					} else {
						tem = true;
					}
				} else {
					tem = false;
					break;
				}
			}
			if ( !tem) {
				if (type == "2") {
					flag = true;
					break;
				}
				if (type == "9") {
					flag = true;
					break;
				}

				if (type == "10") {
					flag = true;
					break;
				}
			}
		} else if (type == "3") {
			var answer = $("#answer" + id).val();
			if ( typeof (answer) == "undefined" || removeAllSpace(answer).length == 0) {
				flag = true;
				break;
			}
		} else if (type == "4" || type == "5" || type == "6" || type == "7" || type == "8" || type == "18") {
			var answer = $("#answer" + id).val();
			var editorAnswer;
			try {
				var optEditor = UE.getEditor("answer" + id);
				if (optEditor != null) {
					editorAnswer = optEditor.getContent();
					maxWordCount = optEditor.options.maximumWords;
					minWordCount = optEditor.options.minimumWords;
					var count = optEditor.pureWordCount();
					if (maxWordCount > 0 && count > maxWordCount) {
						$.toast({
							type : 'failure',
							content : "答案超出教师限制字数，请限定在" + maxWordCount + "字以内"
						});
						return;
					}
					if (minWordCount > 0 && minWordCount > count) {
						$.toast({
							type : 'failure',
							content : "答案字数未达到教师设置的最少字数要求，最少需输入" + minWordCount + "字"
						});
						return;
					}
				}
			} catch (exception) {}
			answer = (editorAnswer && editorAnswer.length != 0 ? editorAnswer : answer);
			if ( typeof (answer) == "undefined" || removeAllSpace(answer).length == 0) {
				flag = true;
				break;
			}
		}else if (type == 22) {
			var objectid = $("#answer" + id).attr("objectid");
			if ( typeof (objectid) == "undefined" || removeAllSpace(objectid).length == 0) {
				flag = true;
				break;
			}
		}
	}

	if ( !flagAnswer) {
		return;
	}
	
	var showTips = "确认提交？";
	if (flag) {
		showTips = "您还有未做完的" + tipStr + "，确认提交吗？";
	}
	workPop(showTips, "提交", "取消", function() {
		submitWork();
	});
}

var submitLock = 0;
function submitWork() {
	if (submitLock != 0) {
		return false;
	}
	submitLock = 1;
	$.toast({
		type : 'loading',
		time : 0,
		content : "正在提交..."
	});

	if ($(".oralTestQue").length > 0) {
		setOralTestAnswer();
		var checkOralTest = setInterval(function () {
			if(	$(".oralTestQue").length == oralTestEndNum) {
				clearInterval(checkOralTest)
				confirmSubmitWork()
			}
		}, 1000);

	} else {
		confirmSubmitWork()

	}
}

function version(url) {
	url += '&ua=' + clientType();
	url += '&formType=' + getformType();
	url += '&saveStatus=' + 1;
	var re = /&version=(\d+)/;
	var version = 1;
	if (re.test(url)) {
		var arr = re.exec(url);
		version += parseInt(arr[1]);
		url = url.replace(re, '&version=' + version);
	} else {
		url = url + '&version=1';
	}
	return url;
}

function confirmSubmitWork (){
	var ajax_url = version($("#submitForm").attr("action"));
	var ajax_type = $("#submitForm").attr("method");
	var ajax_data = $("#submitForm").serialize();

	$.ajax({
		type : ajax_type,
		url : ajax_url,
		data : ajax_data,
		dataType : "json",
		success : function(data) {
			if ( !data.status) {
				$.toast({
					type : 'failure',
					content : data.msg
				});
				submitLock = 0;
				return false;
			}
			
			$("#dialogToast").fadeOut();
	
			if (data.stuStatus == 5) {
				workPop("很遗憾，未达到及格线，请重做", "确定", "取消", function() {
					window.location.href = data.backUrl;
				}, function() {
										closeDo();
				});
			} else {
								closeDo();
			}
		}
	});
}

function closeDo() {
	window.opener = null;
	window.open('', '_self');
	window.close();
}

var saveLock = false;
function saveWork() {
	if (saveLock) {
		return;
	}
	saveLock = true;

	$.toast({
		type : 'loading',
		time : 0,
		content : "正在保存..."
	});

	$("#questionIds").val("402257317,");
	$("#pyFlag").val("1");

			setAllClozeAnswer();
	setReadComprehensionAnswer();
	setProceduralAnswer();

	if ($(".oralTestQue").length > 0) {
		setOralTestAnswer();
		var checkOralTest = setInterval(function () {
			if(	$(".oralTestQue").length == oralTestEndNum) {
				clearInterval(checkOralTest)
				saveAnswer()
			}
		}, 1000);
	} else {
		saveAnswer()
	}
}
function saveAnswer(){
	var ajax_url = $("#submitForm").attr("action") + "&pyFlag=" + $("#pyFlag").val();
	var ajax_type = $("#submitForm").attr("method");
	var ajax_data = $("#submitForm").serialize();
	ajax_url += '&ua=' + clientType();
	ajax_url += '&formType=' + getformType();
	ajax_url += '&saveStatus=' + 1;
	ajax_url += '&version=1';
	$.ajax({
		type : ajax_type,
		url : ajax_url,
		data : ajax_data,
		dataType : "json",
		success : function(data) {
			if (data.status) {
				$.toast({
					type : 'success',
					content : "保存成功！"
				});
			} else {
				$.toast({
					type : 'failure',
					content : data.msg
				});
			}
		},
		complete : function() {
			saveLock = false;
			$("#dialogToast").fadeOut();
		}
	});
}

function clientType() {
	var userAgent = navigator.userAgent;
	var ua = "pc";
	try {
		if (userAgent.indexOf("ChaoXingStudy") > -1) {
			ua = "app";
		}
	} catch (e) {}

	return ua;
}

function getformType() {
	var form_type = $("#form1").attr('method'); //提交方法 
	if (form_type) {
		return form_type;
	}
	return "post";
}

function removeAllSpace(str, value) {
	return str.replace(/<\s?img[^>]*>/gi, "图片").replace(/<\s?iframe[^>]*>/gi, "录音").replace(/<[^>]+>/g, "").replace(/&nbsp;/ig, "").replace(/\s+/g, "");
}

function loadEditorAnswerd(questionId, type) {
	
	var active = 1;
	
	if (type == 2 || type == 9 || type == 10) {
		var blankNum = $("input[name=tiankongsize" + questionId + "]").val();
		for (var j = 1; j <= parseInt(blankNum); j++) {
			var editor = UE.getEditor("answerEditor" + questionId + j);
			var content = editor.getContent();
			if (content.length == 0) {
				active = 0;
				break;
			}
		}
	} else if (type == 11) {
		var answer = $("#answer" + questionId).val();
		var answerArr = JSON.parse(answer);
		for (var index in answerArr) {
			var content = answerArr[index].content;
			if (content.length == 0) {
				active = 0;
				break;
			}
		}
	} else if (type == 13) {
		var answer = $("#answer" + questionId).val();
		if (answer.length == 0 || answer.length < $(".sortSelect" + questionId).size()) {
			active = 0;
		}
	} else if (type == 14) {
		var answer = $("#answer" + questionId).val();
		var answerArr = JSON.parse(answer);
		var answerContent = answerArr[0];
		for (var key in answerContent) {
			var content = answerContent[key];
			var answerStr = content.answer;
			if (answerStr.length == 0) {
				active = 0;
				break;
			}
		}
	} else if (type == 15 || type == 19) {
		$(".readingItem" + questionId).each(function(i, obj) {
			var itemId = $(obj).attr("data");
			var type = $(obj).attr("qtype");
			var itemAnswer = "";
			switch (parseInt(type)) {
				case 0 :
				case 1 : {
					itemAnswer = $("#answer" + itemId).val();
					break;
				}
				case 3 : {
					itemAnswer = $("#answer" + itemId).val();
					break;
				}
				case 2 : {
					var blankNum = $("#blankNum" + itemId).val();
					for (var i = 1; i <= blankNum; i++) {
						var answerEditorId = "answerEditor" + itemId + i;
						itemAnswer = UE.getEditor(answerEditorId).getContent();
						if (itemAnswer.length == 0) {
							break;
						}
					}
					break;
				}
				case 4 : {
					var answerEditorId = "answer" + itemId;
					var answerEditorStr = UE.getEditor(answerEditorId).getContent();
					itemAnswer = answerEditorStr;
					break;
				}
			}
			
			if(itemAnswer.length == 0) {
				active = 0;
				return false
			}
		});
	} else if (type == 17) {
		var editor = UE.getEditor("textarea" + questionId);
		var content = editor.getContent();
		if (content.length == 0) {
			active = 0;
		}
	} else {
		var editor = UE.getEditor("answer" + questionId);
		var content = editor.getContent();
		if (content.length == 0) {
			active = 0;
		}
	}
	
	if (active == 1) {
		$("#answerSheet" + questionId).addClass("active");
	} else {
		$("#answerSheet" + questionId).removeClass("active");
	}
}

$(".B-answerCon span").click(function(){
    var answerCon = $(this).parent();
	answerCon.find("span").removeClass("check_answer");
	$(this).addClass("check_answer");
	setBType(answerCon.parents('.bTypeWrap'));
	
	function setBType(bTypeWrap) {
        var answerCons = bTypeWrap.find('.B-answerCon');
        var answer = [];
        answerCons.each(function(index,obj) {
			var choice = $(this).find("span.check_answer").attr("data") || "";
			var item = {"name" : (index + 1), "content" : choice};
			answer.push(item);
        });
        var answerStr = JSON.stringify(answer);
        bTypeWrap.prev().val(answerStr);
		loadAnswerSheet(bTypeWrap.attr("data"),answerStr);
   }
});

function checkEvaluationQuesNum(object){
	var questionWrap = $(object).parent();
	var qid = $(object).attr("qid");
	var selectNum = $('#selectNum' + qid).val() || 0;
	if(selectNum > 0){
		var alreadyCheckedNum = questionWrap.find('.check_answer_dx').length;
		if($(object).find('.check_answer_dx').length == 0){
			if(parseInt(alreadyCheckedNum) >= parseInt(selectNum)){
				 $.toast({type : 'notice',content : '最多选' + selectNum + '项'});
				return false;
			}
		}
	}
	return true;
}
</script>
</body>
</html>
